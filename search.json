[{"title":"Pyrdp-convertè·¯å¾„Errorsolve","url":"/2025/11/30/Pyrdp-convertè·¯å¾„ErrorSolve/","content":"\n# ***Pyrdp-convertè·¯å¾„ErrorSolve***\n\n\n### 1. é—®é¢˜è¯†åˆ«\n\næ‰§è¡Œ pyrdp-convert rdp_dec.pcap -o out å‘½ä»¤æ—¶å‡ºç°å¤§é‡é”™è¯¯ï¼š\n\n```\n[-] Failed to handle data, continuing anyway: [Errno 2] No such file or \ndirectory: 'D_\\\\Forensicstools\\\\envs\\\\out\\\\20170823082818_192.168.43.\n185_59921-192.168.43.130_3389.pyrdp'\n```\næ³¨æ„åˆ°è·¯å¾„ä¸­çš„ D: è¢«é”™è¯¯åœ°æ›¿æ¢ä¸º D_ ï¼ˆå†’å·å˜æˆäº†ä¸‹åˆ’çº¿ï¼‰ï¼Œå¯¼è‡´ç³»ç»Ÿæ— æ³•æ‰¾åˆ°æ­£ç¡®çš„æ–‡ä»¶è·¯å¾„ã€‚\n\n### 2. å®šä½é—®é¢˜ä»£ç \né€šè¿‡åˆ†æä»£ç ï¼Œæˆ‘å‘ç°é—®é¢˜å‡ºåœ¨ d:\\Forensicstools\\envs\\pyrdp\\pyrdp\\recording\\recorder.py æ–‡ä»¶ä¸­çš„ FileLayer ç±»ï¼š\n\n```\nself.filename = fileName\nself.filename = str(self.filename).replace(\":\", \"_\")  # é”™è¯¯è¡Œï¼šæ›¿æ¢äº†æ‰€æœ‰å†’å·\n```\nè¿™æ®µä»£ç å°†æ–‡ä»¶åä¸­çš„ æ‰€æœ‰ å†’å·æ›¿æ¢ä¸ºä¸‹åˆ’çº¿ï¼ŒåŒ…æ‹¬ Windows é©±åŠ¨å™¨å·ä¸­çš„å†’å·ï¼ˆå¦‚ D: ï¼‰ã€‚\n\n### 3. ä¿®å¤æ–¹æ¡ˆ\næˆ‘ä¿®æ”¹äº†ä»£ç ï¼Œä½¿å…¶èƒ½å¤Ÿè¯†åˆ«å¹¶ä¿ç•™ Windows é©±åŠ¨å™¨å·ä¸­çš„å†’å·ï¼ŒåŒæ—¶æ›¿æ¢æ–‡ä»¶åä¸­å…¶ä»–ä½ç½®çš„å†’å·ï¼š\n\n```\nself.filename = fileName\n# ä¿ç•™ Windows é©±åŠ¨å™¨å·ä¸­çš„å†’å·\nfilename_str = str(self.filename)\nif len(filename_str) > 1 and filename_str[1] == ':':\n    # ä¿ç•™ç¬¬ä¸€ä¸ªå†’å·ï¼ˆé©±åŠ¨å™¨å·ï¼‰\n    self.filename = filename_str[0:2] + filename_str[2:].replace(\":\", \"_\")\nelse:\n    # å¯¹é Windows è·¯å¾„æ›¿æ¢æ‰€æœ‰å†’å·\n    self.filename = filename_str.replace(\":\", \"_\")\n```\n### 4. éªŒè¯ä¿®å¤\nä½¿ç”¨è™šæ‹Ÿç¯å¢ƒä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶æµ‹è¯•ä¿®å¤åçš„å‘½ä»¤ï¼š\n\n```\npyrdp-env\\Scripts\\pyrdp-convert.exe rdp_dec.pcap -o out\n```\nå‘½ä»¤æˆåŠŸæ‰§è¡Œï¼Œç”Ÿæˆäº†é¢„æœŸçš„è¾“å‡ºæ–‡ä»¶ï¼š\n\n```\n[*] Analyzing PCAP 'rdp_dec.pcap' ...\n    - 192.168.43.185:59921 -> 192.168.43.130:3389 : plaintext\n[*] Processing 192.168.43.185:59921 -> 192.168.43.130:3389\n100% (1858 of 1858) || Elapsed Time: 0:00:00 Time:  0:00:00\n\n[+] Successfully wrote 'D:\\Forensicstools\\envs\\out\\20170823082818_192.168.\n43.185_59921-192.168.43.130_3389.pyrdp'\n```\n### 5. ä¿®å¤æ•ˆæœ\nä»è¾“å‡ºç»“æœå¯ä»¥çœ‹åˆ°ï¼Œè·¯å¾„ä¸­çš„é©±åŠ¨å™¨å· D: è¢«æ­£ç¡®ä¿ç•™ï¼Œæ–‡ä»¶æˆåŠŸç”Ÿæˆåœ¨æŒ‡å®šçš„è¾“å‡ºç›®å½•ä¸­ã€‚\n\nè¿™ä¸ªä¿®å¤ç¡®ä¿äº† pyrdp-convert å·¥å…·èƒ½å¤Ÿåœ¨ Windows ç³»ç»Ÿä¸Šæ­£ç¡®å¤„ç†æ–‡ä»¶è·¯å¾„ï¼ŒåŒæ—¶ä¿æŒå¯¹é Windows ç³»ç»Ÿçš„å…¼å®¹æ€§ã€‚","tags":["Error"],"categories":["Error"]},{"title":"EzUSB","url":"/2025/11/30/EzUSB/","content":"\n# ***EzUSB***\n\n<from bugku>\n\nä¸€ä¸ªç®€å•çš„USBæµé‡\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251127100523716.png)\n\nç‚¹å¼€ç¬¬ä¸€ä¸ªæµé‡å‘ç°æŠ“æ•åˆ°payload,ç¬¬ä¸‰ä¸ªå­—èŠ‚ä¸º09.\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251127100934440.png)\n\nè¡¨ç¤ºUSB Deviceå‘HOSTå‘é€äº†ä¿¡æ¯,â€œ**Leftover Capture Data**â€ å°±æ˜¯ *USBPcap* æŠ“åˆ°çš„ EP æ•°æ®ï¼ˆpayloadï¼‰\n\næ ¹æ®HID é”®ç›˜æ ‡å‡†è¡¨:\n\nä»¥ä¸‹**kecode**å¯¹åº”çš„å°±æ˜¯usage ID\n\n| Keycode |  é”®  | ASCII |\n| :-----: | :--: | :---: |\n|  0x04   |  a   |  61   |\n|  0x05   |  b   |  62   |\n|  0x06   |  c   |  63   |\n|  0x07   |  d   |  64   |\n|  0x08   |  e   |  65   |\n|  0x09   |  f   |  66   |\n|  0x0A   |  g   |  67   |\n|  0x0B   |  h   |  68   |\n|  0x0C   |  i   |  69   |\n|  0x0D   |  j   |  6A   |\n|  0x0E   |  k   |  6B   |\n|  0x0F   |  l   |  6C   |\n|  0x10   |  m   |  6D   |\n|  0x11   |  n   |  6E   |\n|  0x12   |  o   |  6F   |\n|  0x13   |  p   |  70   |\n|  0x14   |  q   |  71   |\n|  0x15   |  r   |  72   |\n|  0x16   |  s   |  73   |\n|  0x17   |  t   |  74   |\n|  0x18   |  u   |  75   |\n|  0x19   |  v   |  76   |\n|  0x1A   |  w   |  77   |\n|  0x1B   |  x   |  78   |\n|  0x1C   |  y   |  79   |\n|  0x1D   |  z   |  7A   |\n\né‚£ä¹ˆ09å¯¹åº”çš„å°±æ˜¯é”®ç›˜ä¸Šçš„  **f**\n\nå…¶ä»–çš„é”®å¯¹åº”çš„usage IDçš„è¡¨å¦‚ä¸‹:\n\n###### ***æ•°å­—:***\n\n| Keycode |  é”®  | æœªæŒ‰ Shift | æŒ‰ä¸‹ Shift |\n| :-----: | :--: | :--------: | :--------: |\n|  0x1E   |  1   |    `1`     |    `!`     |\n|  0x1F   |  2   |    `2`     |    `@`     |\n|  0x20   |  3   |    `3`     |    `#`     |\n|  0x21   |  4   |    `4`     |    `$`     |\n|  0x22   |  5   |    `5`     |    `%`     |\n|  0x23   |  6   |    `6`     |    `^`     |\n|  0x24   |  7   |    `7`     |    `&`     |\n|  0x25   |  8   |    `8`     |    `*`     |\n|  0x26   |  9   |    `9`     |    `(`     |\n|  0x27   |  0   |    `0`     |    `)`     |\n\n###### ***æ§åˆ¶é”®***\n\n| Keycode |   åŠŸèƒ½    |\n| :-----: | :-------: |\n|  0x28   |   Enter   |\n|  0x29   |    ESC    |\n|  0x2A   | Backspace |\n|  0x2B   |    Tab    |\n|  0x2C   |   Space   |\n\n###### ***ç¬¦å·é”®***\n\n| Keycode | æœªæŒ‰ Shift |    æŒ‰ä¸‹ Shift     |\n| :-----: | :--------: | :---------------: |\n|  0x2D   |    `-`     |        `_`        |\n|  0x2E   |    `=`     |        `+`        |\n|  0x2F   |    `[`     |        `{`        |\n|  0x30   |    `]`     |        `}`        |\n|  0x31   |    `\\`     |         `         |\n|  0x32   | `Non-US #` | `~`ï¼ˆå› é”®ç›˜è€Œå¼‚ï¼‰ |\n|  0x33   |    `;`     |        `:`        |\n|  0x34   |    `'`     |        `\"`        |\n|  0x35   |    ```     |        `~`        |\n|  0x36   |    `,`     |        `<`        |\n|  0x37   |    `.`     |        `>`        |\n|  0x38   |    `/`     |        `?`        |\n\n###### ***åŠŸèƒ½é”®***\n\n| Keycode |  é”®  |\n| :-----: | :--: |\n|  0x3A   |  F1  |\n|  0x3B   |  F2  |\n|  0x3C   |  F3  |\n|  0x3D   |  F4  |\n|  0x3E   |  F5  |\n|  0x3F   |  F6  |\n|  0x40   |  F7  |\n|  0x41   |  F8  |\n|  0x42   |  F9  |\n|  0x43   | F10  |\n|  0x44   | F11  |\n|  0x45   | F12  |\n\n###### ***å¯¼èˆªé”®***\n\n| Keycode |     é”®      |\n| :-----: | :---------: |\n|  0x4A   |    Home     |\n|  0x4B   |   PageUp    |\n|  0x4C   |   Delete    |\n|  0x4D   |     End     |\n|  0x4E   |  PageDown   |\n|  0x4F   | Right Arrow |\n|  0x50   | Left Arrow  |\n|  0x51   | Down Arrow  |\n|  0x52   |  Up Arrow   |\n\n###### ***å°é”®ç›˜***\n\n| Keycode |    é”®    |\n| :-----: | :------: |\n|  0x53   | Num Lock |\n|  0x54   |    /     |\n|  0x55   |    *     |\n|  0x56   |    -     |\n|  0x57   |    +     |\n|  0x58   |  Enter   |\n|  0x59   |    1     |\n|  0x5A   |    2     |\n|  0x5B   |    3     |\n|  0x5C   |    4     |\n|  0x5D   |    5     |\n|  0x5E   |    6     |\n|  0x5F   |    7     |\n|  0x60   |    8     |\n|  0x61   |    9     |\n|  0x62   |    0     |\n|  0x63   |    .     |\n\nå›åˆ°é‚£ä¸ª***leftover capture data***\n\n```\n00 00 09 00 00 00 00 00\n```\n\nåœ¨ HID Boot Report æ ¼å¼ä¸‹ï¼Œå¯¹æ•°æ® `00 00 09 00 00 00 00 00` å„å­—æ®µçš„å«ä¹‰è§£æå¦‚ä¸‹ï¼š\n\n- **å­—èŠ‚ 0ï¼ˆModifierï¼‰ï¼š` 00`**ï¼šè¡¨ç¤ºæ— ä¿®é¥°é”®è¢«æŒ‰ä¸‹ï¼Œå³æ²¡æœ‰æŒ‰ä¸‹ Ctrlã€Shiftã€Altã€GUI ç­‰ä¿®é¥°é”®ã€‚\n- **å­—èŠ‚ 1ï¼ˆReservedï¼‰ï¼š` 00`**ï¼šè¯¥å­—èŠ‚ä¸ºä¿ç•™å­—èŠ‚ï¼Œåœ¨ HID Boot Report æ ¼å¼ä¸­ä¸åšå…·ä½“ä½¿ç”¨ã€‚\n- **å­—èŠ‚ 2ï¼ˆKeycode #1ï¼‰ï¼š` 09`**ï¼šä»£è¡¨ç¬¬ä¸€ä¸ªè¢«æŒ‰ä¸‹çš„é”®çš„ HID usage IDï¼Œä¹Ÿå°±æ˜¯ç¬¬ä¸€ä¸ªæŒ‰é”®çš„é”®ç ã€‚\n- **å­—èŠ‚ 3 - 7ï¼ˆKeycode #2â€“#6ï¼‰ï¼š` 00 00 00 00 00`**ï¼šè¡¨ç¤ºé™¤äº†ç¬¬ä¸€ä¸ªæŒ‰é”®å¤–ï¼Œæ²¡æœ‰å…¶ä»–éä¿®é¥°é”®è¢«æŒ‰ä¸‹ã€‚\n\næˆ‘ä»¬å†çœ‹ä¸€ä¸ª:\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251127105448599.png)\n\n`Leftover Capture Data: 20002f0000000000` æ˜¯ä¸€ç»„å­—èŠ‚æ•°æ®ï¼ŒæŒ‰ç…§å¸¸è§çš„ HID æŠ¥å‘Šæ ¼å¼ï¼Œå¯å¯¹å…¶å„å­—èŠ‚å«ä¹‰è¿›è¡Œå¦‚ä¸‹è§£æï¼š\n\n### ç¬¬ 1 å­—èŠ‚: 20\n\nå°† `20` è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ˜¯ `0010 0000`ï¼Œè¿™è¡¨ç¤ºç¬¬ 5 ä½è¢«ç½® 1ï¼Œå¯¹åº”çš„æ˜¯ Right Shift é”®è¢«æŒ‰ä¸‹ã€‚æ ¹æ® HID åè®®ä¸­ä¿®é¥°é”®ä½çš„å®šä¹‰ï¼Œè¯¥å­—èŠ‚ç”¨äºè¡¨ç¤ºä¿®é¥°é”®çš„çŠ¶æ€ï¼Œæ‰€ä»¥æ­¤æ•°æ®è¡¨æ˜å½“å‰æŒ‰ä¸‹äº† Right Shift é”® *1*ã€‚\n\n### ç¬¬ 2 å­—èŠ‚: 00\n\né€šå¸¸è¯¥å­—èŠ‚ä¸ºä¿ç•™å­—èŠ‚ï¼Œ` 00` è¡¨ç¤ºæ­¤ä¿ç•™ä½æ— ç‰¹æ®Šå«ä¹‰ã€‚\n\n### ç¬¬ 3 å­—èŠ‚: 2f\n\nå‚è€ƒè„šæœ¬ä¸­çš„æ˜ å°„å…³ç³»ï¼Œ` 0x2F` å¯¹åº”çš„å­—ç¬¦æ˜¯ `[`ï¼Œæ‰€ä»¥è¯¥å­—èŠ‚è¡¨ç¤ºå½“å‰æŒ‰ä¸‹çš„æŒ‰é”®å¯¹åº”çš„æ‰«æç ä¸º `[` ã€‚\n\n### ç¬¬ 4 - 8 å­—èŠ‚: 00000000\n\nè¿™å‡ ä¸ªå­—èŠ‚é€šå¸¸ç”¨äºè¡¨ç¤ºå…¶ä»–æŒ‰é”®ï¼Œ` 00` è¡¨ç¤ºå½“å‰æ²¡æœ‰å…¶ä»–é¢å¤–çš„æŒ‰é”®è¢«æŒ‰ä¸‹ã€‚\n\nç»¼åˆèµ·æ¥ï¼Œ`Leftover Capture Data: 20002f0000000000` è¡¨ç¤ºå½“å‰æŒ‰ä¸‹äº† Right Shift é”®å’Œ `[` é”®ã€‚\n\nRight Shift é”®å’Œ `[` é”®è¿™ä¸ªç»„åˆé”®çš„å¯¹åº”çš„è¾“å…¥å°±æ˜¯    **{**\n\né‚£ä¹ˆæ•´ä¸ªçš„å°±å¯ä»¥å¾—åˆ°æ‰€æœ‰é”®å…¥ä¿¡æ¯.\n\næœ€åå¯ä»¥ä½¿ç”¨  [é’å°‘å¹´CTFåœ¨çº¿å·¥å…·ç®±](https://tools.qsnctf.com/#!)","tags":["CTF"],"categories":["Forensics"]},{"title":"UBIFS","url":"/2025/11/27/UBIFSåŠæ¡ˆä¾‹/","content":"\n**UBIFS**ï¼ˆUnsorted Block Image File Systemï¼‰æ˜¯é’ˆå¯¹é—ªå­˜è®¾å¤‡è®¾è®¡çš„æ–‡ä»¶ç³»ç»Ÿã€‚æˆ‘è¯¦ç»†ä»‹ç»ä¸€ä¸‹UBIFSé•œåƒçš„å¤„ç†å’Œåˆ†æï¼š\n\n## UBIFS æ¦‚è¿°\n\n### **ç‰¹ç‚¹**\n\n- ä¸“ä¸º**åŸå§‹é—ªå­˜è®¾å¤‡**è®¾è®¡\n- æ”¯æŒ**ç£¨æŸå‡è¡¡**ã€**åå—ç®¡ç†**\n- æä¾›**æ•°æ®å‹ç¼©**ã€**æ•°æ®å®Œæ•´æ€§**\n- ç”¨äºåµŒå…¥å¼Linuxç³»ç»Ÿ\n\n## UBIFSé•œåƒç»“æ„\n\n### **é•œåƒç»„æˆ**\n\ntext\n\n```\nUBIFSé•œåƒ â†’ UBIå· â†’ UBIFSæ–‡ä»¶ç³»ç»Ÿ\n    â†“           â†“           â†“\n  .ubifæ–‡ä»¶  åŒ…å«å¤šä¸ª  å®é™…æ–‡ä»¶ç³»ç»Ÿ\n             ç‰©ç†æ“¦é™¤å—\n```\n\n\n\n### **å±‚æ¬¡ç»“æ„**\n\ntext\n\n```\nRaw Flash\n    â†“\nMTD (Memory Technology Device) \n    â†“  \nUBI (Unsorted Block Images)\n    â†“\nUBIFS (File System)\n```\n\n\n\n## å¤„ç†UBIFSé•œåƒçš„å·¥å…·\n\n### **ä¸»è¦å·¥å…·é›†**\n\nbash\n\n```\n# MTDå·¥å…·\nmtdinfo, flash_erase, nandwrite\n\n# UBIå·¥å…·  \nubinize, ubiformat, ubiattach\n\n# UBIFSå·¥å…·\nmkfs.ubifs, ubirmvol, ubiupdatevol\n```\n\n\n\n## é•œåƒæå–å’Œåˆ†ææ­¥éª¤\n\n### **1. è¯†åˆ«é•œåƒç±»å‹**\n\nbash\n\n```\n# æ£€æŸ¥æ–‡ä»¶ç±»å‹\nfile image.ubifs\nhexdump -C image.ubifs | head -20\n\n# æŸ¥æ‰¾UBIé­”æœ¯å­—\ngrep -a \"UBI#\" image.ubifs\n```\n\n\n\n### **2. æå–UBIå·**\n\nbash\n\n```\n# ä½¿ç”¨ubinfoæŸ¥çœ‹é•œåƒä¿¡æ¯\nubinfo --image image.ubifs\n\n# æŒ‚è½½UBIFSé•œåƒ\nsudo modprobe nandsim first_id_byte=0xec second_id_byte=0xa1\nsudo modprobe ubi mtd=0\nsudo ubiformat /dev/mtd0 -f image.ubifs\nsudo ubiattach /dev/ubi_ctrl -m 0\nsudo mount -t ubifs ubi0:rootfs /mnt/ubifs\n```\n\n\n\n### **3. ç›´æ¥è§£æUBIFSï¼ˆæ— éœ€ç¡¬ä»¶ï¼‰**\n\nbash\n\n```\n# ä½¿ç”¨ubireaderæå–æ–‡ä»¶\nubireader_extract_files -i image.ubifs -o extracted_files/\n\n# ä½¿ç”¨ubidumpåˆ†æç»“æ„\nubidump image.ubifs\n```\n\n\n\n## ä½¿ç”¨UBIå·¥å…·å¤„ç†\n\n### **åˆ›å»ºUBIé•œåƒ**\n\nbash\n\n```\n# ä»ç›®å½•åˆ›å»ºUBIFSé•œåƒ\nmkfs.ubifs -r rootfs/ -m 2048 -e 126976 -c 1024 -o ubifs.img\n\n# åˆ›å»ºUBIé•œåƒ\nubinize -o image.ubifs -m 2048 -p 128KiB ubinize.cfg\n```\n\n\n\n### **ubinizeé…ç½®æ–‡ä»¶ç¤ºä¾‹**\n\nini\n\n```\n[ubifs]\nmode=ubi\nimage=ubifs.img\nvol_id=0\nvol_size=100MiB\nvol_type=dynamic\nvol_name=rootfs\nvol_flags=autoresize\n```\n\n\n\n## ç¼–ç¨‹æ–¹å¼å¤„ç†UBIFS\n\n### **Pythonå¤„ç†ç¤ºä¾‹**\n\npython\n\n```\nimport subprocess\nimport os\n\ndef extract_ubifs(image_path, output_dir):\n    \"\"\"æå–UBIFSé•œåƒå†…å®¹\"\"\"\n    if not os.path.exists(output_dir):\n        os.makedirs(output_dir)\n    \n    # ä½¿ç”¨ubireader_extract_files\n    cmd = ['ubireader_extract_files', '-i', image_path, '-o', output_dir]\n    result = subprocess.run(cmd, capture_output=True, text=True)\n    \n    if result.returncode == 0:\n        print(\"UBIFSé•œåƒæå–æˆåŠŸ\")\n        return True\n    else:\n        print(f\"æå–å¤±è´¥: {result.stderr}\")\n        return False\n\ndef analyze_ubifs_structure(image_path):\n    \"\"\"åˆ†æUBIFSç»“æ„\"\"\"\n    # è¯»å–é­”æœ¯å­—å’ŒåŸºæœ¬ä¿¡æ¯\n    with open(image_path, 'rb') as f:\n        header = f.read(64)\n        \n    print(\"é•œåƒå¤´éƒ¨ä¿¡æ¯:\")\n    print(f\"é­”æœ¯å­—: {header[:4]}\")\n    print(f\"ç‰ˆæœ¬: {header[4:8]}\")\n    print(f\"æ•°æ®åç§»: {int.from_bytes(header[8:12], 'little')}\")\n```\n\n\n\n### **è§£æUBIå¤´ä¿¡æ¯**\n\npython\n\n```\nimport struct\n\ndef parse_ubi_ec_hdr(data):\n    \"\"\"è§£æUBI ECå¤´\"\"\"\n    magic = data[0:4]\n    version = data[4:8]\n    ec = struct.unpack('<I', data[8:12])[0]  # æ“¦é™¤è®¡æ•°å™¨\n    vid_hdr_offset = struct.unpack('<I', data[12:16])[0]\n    data_offset = struct.unpack('<I', data[16:20])[0]\n    \n    return {\n        'magic': magic,\n        'version': version,\n        'erase_counter': ec,\n        'vid_hdr_offset': vid_hdr_offset,\n        'data_offset': data_offset\n    }\n```\n\n\n\n## åœ¨æ•°å­—å–è¯ä¸­çš„åº”ç”¨\n\n### **å–è¯åˆ†ææ­¥éª¤**\n\nbash\n\n```\n# 1. åˆ›å»ºé•œåƒå‰¯æœ¬\ndd if=/dev/mtd0 of=flash_dump.bin bs=1M\n\n# 2. åˆ†æMTDåˆ†åŒº\nmtdinfo flash_dump.bin\n\n# 3. æå–UBIFSå†…å®¹\nubireader_extract_images -i flash_dump.bin -o extracted_volumes/\n\n# 4. æ–‡ä»¶ç³»ç»Ÿåˆ†æ\nls -la extracted_volumes/\nfind extracted_volumes/ -name \"*.conf\" -o -name \"*.sh\"\n```\n\n\n\n### **é‡è¦æ•°æ®ä½ç½®**\n\nbash\n\n```\n# é…ç½®æ–‡ä»¶\n/etc/passwd\n/etc/shadow\n/etc/network/interfaces\n\n# æ—¥å¿—æ–‡ä»¶\n/var/log/messages\n/var/log/auth.log\n\n# ç”¨æˆ·æ•°æ®\n/home/\n/root/\n/tmp/\n```\n\n\n\n## å¸¸è§é—®é¢˜è§£å†³\n\n### **1. æŒ‚è½½å¤±è´¥**\n\nbash\n\n```\n# é”™è¯¯: UBI device 0 not found\nsudo modprobe ubi\nsudo ubiattach /dev/ubi_ctrl -m 0 -d 0\n\n# é”™è¯¯: Invalid argument\n# æ£€æŸ¥PEBå¤§å°æ˜¯å¦åŒ¹é…\nubinfo --image image.ubifs\n```\n\n\n\n### **2. é•œåƒæŸå**\n\nbash\n\n```\n# å°è¯•ä¿®å¤\nubirepair image.ubifs\n\n# å¼ºåˆ¶æŒ‚è½½\nsudo ubiformat /dev/mtd0 -f image.ubifs -s 2048\n```\n\n\n\n## é«˜çº§åˆ†ææŠ€å·§\n\n### **æ¢å¤åˆ é™¤æ–‡ä»¶**\n\nbash\n\n```\n# UBIFSåˆ é™¤æ–‡ä»¶æ¢å¤è¾ƒéš¾ï¼Œä½†å¯ä»¥å°è¯•ï¼š\n# 1. æ‰«æåŸå§‹é•œåƒå­—ç¬¦ä¸²\nstrings flash_dump.bin | grep -i \"password\"\n\n# 2. åˆ†ææœªåˆ†é…æ“¦é™¤å—\nubireader_display -i image.ubifs\n```\n\n\n\n### **æ—¶é—´çº¿åˆ†æ**\n\nbash\n\n```\n# æå–æ–‡ä»¶æ—¶é—´ä¿¡æ¯\nfind extracted_volumes/ -type f -exec stat {} \\; > timeline.txt\n\n# åˆ†æä¿®æ”¹æ—¶é—´\ncat timeline.txt | grep \"Modify\"\n```\n\n\n\n## å®é™…æ¡ˆä¾‹\n\n### **è·¯ç”±å™¨å›ºä»¶åˆ†æ**\n\nbash\n\n```\n# ä¸‹è½½è·¯ç”±å™¨å›ºä»¶\nwget http://example.com/firmware.bin\n\n# æå–UBIFSåˆ†åŒº\nbinwalk -e firmware.bin\n\n# åˆ†ææå–çš„æ–‡ä»¶\ncd _firmware.bin.extracted/\nubireader_extract_files -i *.ubifs -o router_fs/\n```\n\n\n\n### **åµŒå…¥å¼è®¾å¤‡å–è¯**\n\npython\n\n```\n# è‡ªåŠ¨åŒ–åˆ†æè„šæœ¬\nimport os\nimport hashlib\n\ndef analyze_embedded_device(image_path):\n    \"\"\"åˆ†æåµŒå…¥å¼è®¾å¤‡é•œåƒ\"\"\"\n    print(\"=== UBIFSé•œåƒåˆ†ææŠ¥å‘Š ===\")\n    \n    # 1. åŸºæœ¬ä¿¡æ¯\n    size = os.path.getsize(image_path)\n    print(f\"é•œåƒå¤§å°: {size} bytes\")\n    \n    # 2. æå–æ–‡ä»¶\n    extract_dir = \"extracted_fs\"\n    if extract_ubifs(image_path, extract_dir):\n        # 3. åˆ†ææå–çš„æ–‡ä»¶\n        for root, dirs, files in os.walk(extract_dir):\n            for file in files:\n                filepath = os.path.join(root, file)\n                print(f\"æ‰¾åˆ°æ–‡ä»¶: {filepath}\")\n```\n\n\n\n## å·¥å…·å®‰è£…\n\n### **Ubuntu/Debian**\n\nbash\n\n```\nsudo apt update\nsudo apt install mtd-utils ubi-utils binwalk\n```\n\n\n\n### **CentOS/RHEL**\n\nbash\n\n```\nsudo yum install mtd-utils\n# éœ€è¦ä»æºç ç¼–è¯‘ubi-utils\ngit clone https://github.com/oberhumer/ubi-utils\ncd ubi-utils && make\n```\n\n\n\n## æ€»ç»“\n\n**UBIFSé•œåƒåˆ†æå…³é”®ç‚¹**ï¼š\n\n**ä½¿ç”¨æ­£ç¡®çš„å·¥å…·é“¾**ï¼ˆmtd-utils, ubi-utilsï¼‰\n**è§£å±‚æ¬¡ç»“æ„**ï¼ˆMTDâ†’UBIâ†’UBIFSï¼‰\n**æ³¨æ„å‚æ•°åŒ¹é…**ï¼ˆPEBå¤§å°ã€å—å¤§å°ï¼‰\n\n**å¤‡ä»½åŸå§‹é•œåƒ**å†è¿›è¡Œæ“ä½œ\n\nä½¿ç”¨ubi_readerï¼ˆæ¨èï¼‰\nbash\n\n### å®‰è£…ubi_reader\nsudo apt install python3-pip\npip3 install ubi_reader\n\n### æå–UBIå·ä¿¡æ¯\nubinfo --image firmware.ubifs\n\n### æ˜¾ç¤ºè¯¦ç»†ç»“æ„\nubireader_display -i firmware.ubifs\n\n### æå–æ‰€æœ‰æ–‡ä»¶\nubireader_extract_files -i firmware.ubifs -o extracted_fs/\n\n\n\n","tags":["Basics"],"categories":["Basics"]},{"title":"DNS Courier","url":"/2025/11/27/DNS Courier/","content":"\n# ***DNS Courier***\n\n*<from NSSCTFï¼ˆCTFï¼‰>*  \n\nå‘ç°è®¿é—®äº†å¤šæ¬¡å¥‡æ€ªçš„åŸŸåè¯·æ±‚ã€‚\n\nè¿‡æ»¤è¿™ç±»è¯·æ±‚ï¼ˆè‡ªè¡Œæƒ³åŠæ³•è¿‡æ»¤ï¼‰\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126163147555.png)\n\nç„¶åå°†è¿™ç±»æµé‡åŒ…æå–æ‰“åŒ…æˆå¦ä¸€ä¸ªpcapngæ–‡ä»¶ï¼ˆå¦‚æœå«ŒåŸæ¥çš„æµé‡åŒ…åˆ†æèµ·æ¥æ…¢çš„è¯ï¼‰\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126163224605.png)\n\nå¯ä»¥å‘ç°æŒ‰æ—¶é—´é¡ºåºæ’åºçš„ç¬¬ä¸€ä¸ªåŸŸåè¯·æ±‚åŒ…å«504B0304ï¼Œé‚£ä¹ˆå¯ä»¥è”æƒ³åˆ°ä½œè€…å°†å‹ç¼©åŒ…å…ƒæ•°æ®ä½œä¸ºåŸŸåè¯·æ±‚äº†ã€‚\n\nç„¶åæˆ‘ä»¬è‡ªç„¶è€Œç„¶æƒ³åˆ°æå–è¿™äº›æ•°æ®è¿˜åŸå‹ç¼©åŒ…ã€‚\n\nä½†æ˜¯è¿™é‡Œè¶³è¶³æœ‰20ä¸‡æ¡æµé‡åŒ…ï¼Œä¹Ÿå°±æ˜¯æœ€å°‘éœ€è¦20ä¸‡è¡Œçš„æ‰¹å¤„ç†ï¼Œè¿™é‡Œæœ‰äººè¯´ç”¨ä»£ç è·‘ï¼Œä½†æ˜¯å¹¶ä¸å»ºè®®ï¼Œæˆ‘ä»¬å…ˆæå–æ•°æ®ã€‚\n\nå› ä¸ºå·²ç»è¿‡æ»¤å‡ºäº†å«æœ‰è¿™äº›å…ƒæ•°æ®çš„æµé‡åŒ…ï¼Œæˆ‘ä»¬å¯ä»¥å…¨é€‰**ï¼ˆCTRL+Aï¼‰**ï¼Œè¿›è¡Œæå–ã€‚\n\nç„¶åæŒ‰å›¾ç¤ºæ“ä½œå¤åˆ¶ä¸ºæ–‡æœ¬ã€‚\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126163245257.png)\n\nä»¥ä¸‹å°±æ˜¯å¾—åˆ°çš„æ•°æ®äº†ï¼Œä½†æ˜¯è¯¥æ€ä¹ˆå¤„ç†å‘¢ã€‚\n\næˆ‘è¯•è¿‡äº†å¾ˆå¤šç§ç¼–è¾‘å™¨ï¼ŒVSCï¼ŒSubï¼Œnotepad++ï¼ˆä½†æ˜¯éƒ½ç”±äºé€‰ä¸­æ•°é‡æœ‰é™ï¼ŒåŒæ—¶è¡Œä¸å¯¹é½è€ŒåŠ å‰§äº†æ›´å¤šçš„å·¥ä½œé‡ï¼‰ã€‚ã€‚ã€‚ã€‚ã€‚æœ€åæˆ‘å†³å®šç”¨010editorè¿›è¡Œå¯¹æ•°æ®çš„æ•´ç†å’Œæå–ã€‚ä»¥ä¸‹æ˜¯æˆ‘ç”¨010editorè¿›è¡Œæ•°æ®æ•´ç†æå–çš„è¿‡ç¨‹ã€‚\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126163309208.png)\n\nOKè¶³è¶³æœ‰20å¤šä¸‡è¡ŒğŸ™Œ\n\næˆ‘ä»¬è¿›è¡Œå¤„ç†ï¼Œè¿™é‡Œ010editorçš„æ–¹ä¾¿ä¹‹å¤„å°±åœ¨äºå…¶å¯ä»¥å¯¹ä»»æ„åŒºçš„æ•°æ®è¿›è¡Œé€‰ä¸­(åˆ é™¤ã€‚ã€‚ã€‚ï¼‰æ“ä½œã€‚å›¾ç¤ºï¼š\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126163333037.png)\n\næŒ‰ä½CRTLç„¶åæ‹–åŠ¨é¼ æ ‡è¿›è¡Œé€‰ä¸­ç‰¹å®šåŒºåŸŸï¼Œå½“ç„¶è¿™é‡Œçš„æ•°æ®ä¸æ­¢éœ€è¦é€‰ä¸­è¿™ä¸€ç‚¹ï¼ˆè¿™é‡Œåªåšæ¼”ç¤ºï¼‰ï¼Œå®é™…å¤„ç†åçš„æ•°æ®åº”è¯¥æ˜¯è¿™æ ·ã€‚\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126163358305.png)\n\nå…¨é€‰å¤åˆ¶åå¯ä»¥é‡æ–°æ–°å»ºä¸€ä¸ªç©ºç™½é¡µã€‚\n\næ³¨æ„ï¼šè¿™é‡Œæ˜¯CTRL+SHIFT+Vè¿›è¡Œç²˜è´´æ‰ä¼šä½œä¸º16è¿›åˆ¶æ•°=æ•°æ®è¢«å­˜å‚¨åœ¨å·¦ä¾§16è¿›åˆ¶æ•°æ®æ®µã€‚\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126163418753.png)\n\nç‚¹å‡»HEXï¼Œå°±å¯ä»¥çœ‹åˆ°ã€‚ç„¶åå†ä¿å­˜ä¸ºzipæ–‡ä»¶å³å¯ã€‚å‘ç°æ˜¯ä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…ã€‚\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126163440439.png)\n\næ¥ä¸‹æ¥å°±åˆ°äº†åƒğŸ’©ç¯èŠ‚,é¦–å…ˆ,è¿™æ˜¯ä¸€ä¸ªæ˜æ–‡æ”»å‡»æ²¡é—®é¢˜,ä½†ä¸æ˜¯pngä½œä¸ºæ˜æ–‡æ–‡ä»¶,è€Œæ˜¯pdf,æœ‰å¯èƒ½æœ‰äººä¼šæƒ³åˆ°æœªæ˜æ–‡æ”»å‡»,ç”¨bkcrackå»çˆ†ç ´.\n\nä½†æœ€åè¿˜æ˜¯çˆ†ç ´ä¸å‡ºæ¥.\n\næˆ‘ä»¬ä¸€ç›´æœ‰ä¸ªç–‘æƒ‘:ä¹‹å‰æå–çš„å‹ç¼©åŒ…å…ƒæ•°æ®çš„æ•´åˆ,æœ€åä¸€è¡Œå¹¶æ²¡æœ‰ç”¨åˆ°,è°èƒ½æƒ³åˆ°é‚£æ˜¯pdfæ–‡ä»¶md5å€¼.\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126163829146.png)\n\næ­£ç¡®æ€è·¯æ˜¯æ ¹æ®md5å€¼é€šè¿‡æœç´¢å¼•æ“æ‰¾åˆ°åŸæ–‡ä»¶.......\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126162154194.png)\n\nè¿™é‡Œæˆ‘è®¿é—®çš„ç¬¬ä¸€ä¸ªå¹³å°ç½‘å€æ¥æŸ¥è¯¢md5\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126162156690.png)\n\nå‘ç°å’ŒåŠ å¯†å‹ç¼©åŒ…ä¸­çš„ä¸€è‡´.\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126162158695.png)![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126162159942.png)\n\næœ€åè¿˜æ˜¯GOOGLEæœç´¢å¼•æ“æ‰æ‹¿åˆ°äº†md5ä¸€è‡´çš„åŸæ–‡ä»¶.\n\nä¹‹åå°±æ˜¯ç†Ÿæ‚‰çš„é…æ–¹ç†Ÿæ‚‰çš„å‘³é“äº†.\n\nåŸæ–‡ä»¶å‹ç¼©æˆå‹ç¼©åŒ…è¿›è¡Œæ˜æ–‡æ”»å‡».\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126162245302.png)\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126162242230.png)\n\nç„¶åæˆ‘ä»¬å¾—åˆ°æ˜æ–‡æ”»å‡»åçš„åŠ å¯†å‹ç¼©åŒ…çš„å¯†ç \n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126162246964.png)\n\nç„¶åæ˜¯å¾—åˆ°äº†ä¸€ä¸ªäºŒç»´ç å›¾ç‰‡.\n\nç”¨è¿™ä¸ªç½‘ç«™å·¥å…·:[QRazyBox - QR Code Analysis and Recovery Toolkit](https://merri.cx/qrazybox/)\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126162310033.png)\n\nè¿›è¡Œæ“ä½œ,å…·ä½“åŠŸèƒ½aiè·å–\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126162249602.png)\n\nextractä¸€ä¸‹å¾—åˆ°flag.    ***OVER***\n\n(â—'â—¡'â—)\n","tags":["CTF"],"categories":["Forensics"]},{"title":"æ”»é˜²ä¸–ç•ŒHITBGSEC CTF 2017 - arrdeepee (Misc)","url":"/2025/11/26/Misc-HITBGSEC CTF 2017-arrdeepee/","content":"\n# ***Arrdeepee***\n\n*<from GFSJ>*\n\né¢˜ç›®æè¿°:\n\næˆ‘ä»¬æŸä¸€ä¸ªboxè¢«pwnäº†ã€‚åœ¨æ£€æŸ¥è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å‘ç°äº†ä¸€ä¸ªå«mimikatzçš„ä¸œè¥¿ï¼Œæˆ‘ä»¬ä»¥å‰æ²¡æœ‰å®‰è£…è¿‡ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¸…é™¤äº†ï¼Œå¹¶ä¸”é‡æ–°å®‰è£…äº†boxã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬å¿˜è®°å¤‡ä»½æˆ‘ä»¬çš„flagæ–‡ä»¶äº†ã€‚å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ”»å‡»è€…ç½‘ç»œæµé‡æ•è·ã€‚ä½ å¯ä»¥å¸®æˆ‘ä»¬æ¢å¤å‡ºflagæ–‡ä»¶å—ï¼Ÿ\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126141149861.png)\n\næµé‡åˆ†æ,åºŸè¯ä¸å¤šè¯´,ç›´æ¥å¼€å§‹.\n\nå‘ç°å¤§é‡tls,åŒæ—¶è¿˜æœ‰è¾ƒä¸ºç½•è§çš„rdpæµé‡,æ²¡æ¥è§¦è¿‡,è¯•è¯•.\n\næˆ‘ä»¬çŸ¥é“rdpæµé‡ä¸­ **TPKT æ˜¯ RDP çš„ä¼ è¾“å°è£…å±‚**,åŒæ—¶é»˜è®¤ç«¯å£ï¼š**TCP 3389**, è¿™ç§æƒ…å†µä¸‹å¦‚æœæ²¡æœ‰TPKTæµé‡,å°±éœ€è¦wiresharkå¯¹åè®®è¿›è¡Œè§£æ:\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126145516901.png)\n\nå°†ä»59921ç«¯å£å‘å¾€3389ç«¯å£çš„TCPåè®®è§£æä¸ºTPKTåè®®,å°±å¯ä»¥çœ‹åˆ°äº†.\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126140244616.png)\n\né‚£è¿™æ—¶æˆ‘ä»¬çœ‹ä¸€ä¸‹æ¯”è¾ƒæœ‰å«Œç–‘çš„RDPæµé‡,å‘ç°å…¶è¢«TLSåŠ å¯†äº†,è¿™æ—¶æˆ‘ä»¬çš„ç›®çš„å°±å˜æˆäº†å¯»æ‰¾key.\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126151315370.png)\n\né‚£ä¹ˆkeyå°±å¤§æ¦‚ç‡å‡ºç°åœ¨UDPæµé‡åŒ…ä¸­äº†,æ ¹æ®åè®®åˆ†çº§ç»Ÿè®¡,å‘ç°UDPå æ¯”è¿˜æ˜¯å¾ˆé«˜çš„.\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126151442300.png)\n\næˆ‘ä»¬è¿½è¸ªä¸€ä¸‹UDPçš„æµé‡åŒ….\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126151518276.png)\n\nå¤§è‡´çœ‹ä¸€ä¸‹,å‘ç°å¹¶ä¸æ˜¯å¸¸è§æ–‡ä»¶,ä½†æ˜¯ä»”ç»†è§‚å¯Ÿä¸éš¾å‘ç°tss,keyç­‰å­—æ ·,æŸ¥é˜…èµ„æ–™:\n\n```\nTSSEcKeySet10\n```\n\nTSSE = Terminal Services Security\n EcKeySet10 = KeySet æ ‡è¯†\n â†’ **CredSSP / RDP å®‰å…¨æ¡æ‰‹æ•°æ®**\n\n```\nMicrosoft Strong Cryptographic Provider\n```\n\nè¿™æ®µ hex å±äº **CredSSP / NTLM / TLS over RDP** æµé‡ä¸­çš„ **ASN.1 ç¼–ç ç»“æ„**ï¼Œå¸¸è§äºï¼š\n\n###### âœ” RDP æ¡æ‰‹\n\n###### âœ” NTLMSSP AUTH\n\n###### âœ” å…¬é’¥ä¼ é€’ï¼ˆPublic Key Authenticationï¼‰\n\n###### âœ” åŠ å¯†æä¾›ç¨‹åºæ ‡è¯†ï¼ˆCrypto Provider Nameï¼‰\n\nç‰¹åˆ«æ˜¯ï¼š\n\n- `Microsoft Strong Cryptographic Provider` â†’ Windows é»˜è®¤åŠ å¯†æä¾›å™¨åç§°\n\n- `TSSEcKeySet10` â†’ RDP/CredSSP å¯†é’¥äº¤æ¢ç»“æ„\n\n  æ€»çš„æ¥è¯´, è¿™æ— ç–‘å°±æ˜¯æˆ‘ä»¬éœ€è¦å¯»æ‰¾çš„å…³é”®keyæ‰€åœ¨æ–‡ä»¶.\n\nå°†è¿™æ®µæ•°æ®å®Œæ•´dumpä¸‹æ¥.\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126152301513.png)\n\nè¿›ä¸€æ­¥åˆ†æ,é¦–å…ˆä¸¢è¿›éšæ³¢é€æµé‡Œçœ‹çœ‹.\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126152428856.png)\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126153708468.png)\n\n\n\n1: Certificate in DER format (x509 v3), header length: 4, sequence length: 2376\n2: Certificate in DER format (x509 v3), header length: 4, sequence length: 1466\n3: Private key in DER format (PKCS header length: 4, sequence length: 860)\n\nâœ” Binwalk æ£€æµ‹åˆ°ï¼š\né¡¹\tç±»å‹\tæ ¼å¼\té•¿åº¦è¯´æ˜\n1\tè¯ä¹¦\tX.509 v3 DER\tSequence 2376 bytes\n2\tè¯ä¹¦\tX.509 v3 DER\tSequence 1466 bytes\n3\tç§é’¥\tPrivate Key (PKCS#1 / PKCS#8) DER\tSequence 860 bytes\n\nä¹Ÿå°±æ˜¯è¯´ï¼Œæ–‡ä»¶é‡ŒåŒ…å«ï¼š\n\nğŸŸ¦ ä¸¤ä»½è¯ä¹¦ï¼ˆå¾ˆå¯èƒ½æ˜¯ï¼šæœåŠ¡å™¨è¯ä¹¦ä¸­é—´è¯ä¹¦ or å®¢æˆ·ç«¯è¯ä¹¦ï¼‰       ğŸŸ¥ ä¸€ä»½ç§é’¥\n\né‚£ä¹ˆæ˜¾ç„¶æˆ‘ä»¬éœ€è¦å°†ç§é’¥æå–,æ¥ä¸‹æ¥å¼€å§‹æå–å·¥ä½œ.\n\nè¿™é‡Œæˆ‘ä»¬ç”¨opensslè¿›è¡Œè§£å¯†æå–,\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126152913220.png)\n\n\n\n```\nopenssl pkcs12 -in data.bin -nocerts -nodes -out private.key\n```\n\nOpenSSL æç¤ºï¼š\n\n```\nEnter Import Password:\n```\n\nè¿™é‡Œçš„å¯†ç è¯´æ˜¯é¢˜ç›®æè¿°ä¸­çš„mimikatz,è¾“å…¥ä¹‹åå³å¯æ‹¿åˆ°ç§é’¥æ–‡ä»¶.  (å…³äºmimikatzä¼šæœ‰å¦ä¸€æ–‡ç« ä»‹ç»).\n\nç§é’¥æ–‡ä»¶å†…å®¹:\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126153803695.png)\n\nå¾ˆæ˜æ˜¾æ˜¯RSAç§é’¥çš„æ ‡å‡†æ ¼å¼.\n\næˆ‘ä»¬è¿›è¡Œç§é’¥è§£å¯†åŠ å¯†æµé‡åè®®.\n\næˆ‘è¿™é‡Œç›´æ¥ç”¨å‘½ä»¤è¡Œå¯¹ç¬¬ä¸ƒå±‚è¿›è¡Œè§£å¯†å‡ºçš„.\n\n`tshark -r \"rdp.pcap\" -d \"tcp.port==3389,tls\" -o \"tls.keys_list:0.0.0.0,0,tpkt,private.key\" -o \"tpkt.tcp.port:3389\" -U \"OSI layer 7\" -F \"pcap\" -w \"rdp_dec.pcap\"`\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126154824142.png)\n\nè§£å¯†æˆåŠŸ!è¿™é‡Œå°±å¯ä»¥çœ‹åˆ°å¤§é‡RDPæµäº†.\n\nä¹‹åçš„æ­¥éª¤æˆ‘ä¹Ÿæ²¡è§è¿‡,æ€»çš„å°±æ˜¯é‡æ”¾ä¸€ä¸‹ä¸­é—´äººæ”»å‡»,å› ä¸ºå®˜æ–¹ç”¨çš„å·¥å…·åå¹´å‰çš„ç‰ˆæœ¬,æ— äººé—®æ´¥äº†,åŒ…æ‹¬ä¼šå‡ºç°å„ç§å…¼å®¹æ€§,åº“ç­‰ç­‰é—®é¢˜,æ‰€ä»¥è¿™é‡Œæ±‚åŠ©å¤§ä½¬å¾—çŸ¥äº†ä¸€ä¸ªå·¥å…·------pyrdp\n\nå…·ä½“æƒ³äº†è§£ä½¿ç”¨æ•™ç¨‹å’ŒåŸç†çš„å¯ä»¥çœ‹çœ‹è¿™ä¸ªè€å¤–çš„ä¸€ä¸ªæ•™ç¨‹:\n\n[PyRDP: Remote Desktop Protocol MITM for Purple Teamers - Black Hat Arsenal 2022](https://www.youtube.com/watch?v=cSJ4-gXiNv4&t=29s)\n\næ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„é¢˜ç›®,å³ä½¿æ˜¯pyrdpè¿™ä¸ªå·¥å…·åœ¨æ²¡æœ‰å…·ä½“çš„æ•™ç¨‹çš„æƒ…å†µè¿˜æ˜¯éå¸¸çš„éš¾ç”¨.\n\næˆ‘ä»¬è¿›è¡Œç®€å•çš„ä¸€ä¸ªå‘½ä»¤å¯¹è§£å¯†çš„æµé‡åŒ…æ–‡ä»¶è¿›è¡ŒéªŒè¯,å¦‚æœæ²¡æœ‰è§£å¯†æˆåŠŸå°±ä¼šæŠ¥é”™unknown tls.\n\n```\npyrdp-convert rdp_dec.pcap -o out \n```\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126155822236.png)\n\n```\npyrdp-convert -f mp4 -o \"è‡ªå®šä¹‰è¾“å‡ºè·¯å¾„\" \"è§£å¯†çš„åçš„rdpæµé‡åŒ…æ–‡ä»¶è·¯å¾„\"\n```\n\nè¿™é‡Œæˆ‘å½“æ—¶ä¸å¤ªä¼šä½¿ç”¨å¯¼è‡´ç›´æ¥ç”¨pyrdp-convertå‘½ä»¤è¿›è¡Œå¯¹rdpè¿˜åŸä¸ºmp4æ–‡ä»¶,ä½†æ˜¯ä»…ä»…è¿˜åŸè§†é¢‘æ–‡ä»¶æ²¡ä»€ä¹ˆç”¨,éœ€è¦è§†é¢‘ä¸­çš„è¾“å…¥ä¿¡æ¯(å³å‰ªåˆ‡æ¿ä¿¡æ¯).\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126160120503.png)\n\nä½†æ˜¯ç”±äºpyrdpçš„é™åˆ¶, pyrdp-player(å¯ä»¥UIå›¾å½¢åŒ–) é‡æ”¾æ–‡ä»¶æ—¶,æ–‡ä»¶æ ¼å¼å¿…é¡»ä¸ºpyrdp(å¦‚æœä¸è½¬æ¢ç›´æ¥ç”¨playerè¿›è¡Œé‡æ”¾ä¼šå‡ºç°å†…å­˜æŠ¥é”™),ä½†æ˜¯åœ¨è½¬æ¢æ—¶è€æ˜¯æŠ¥é”™,æ— å¥ˆæˆ‘è¿™é‡Œåªèƒ½ä½¿ç”¨mcp(trae)è¿›è¡Œäº†å¯¹å·¥å…·æºç è¿›è¡Œç¯¡æ”¹(ä¼¼ä¹ä¹Ÿå¢æ·»äº†ä¸€ä¸ªæ‰©å±•),ä½¿å…¶å¯ä»¥è¢«è‡ªåŠ¨è½¬æ¢ä¸ºpyrdpæ–‡ä»¶è¿›è¡Œé‡æ”¾.\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126161206779.png)\n\nå¯ä»¥çœ‹åˆ°è½¬æ¢æˆåŠŸ,æ‰€ä»¥è¯´åœ¨åŠŸèƒ½æ€§çš„å¼€å‘ä¸Š,mcpè¿˜æ˜¯å…·æœ‰å¾ˆå¤§çš„ä¼˜åŠ¿å’Œè§£å†³é—®é¢˜çš„èƒ½åŠ›çš„.\n\n\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126161515026.png)\n\nè¿™æ ·çš„è¯å°±è½»æ¾å¤šäº†,æ•´ä¸ªè¿‡ç¨‹æœ€å¤æ‚å¤´ç–¼çš„è¿˜æ˜¯è¿™ä¸ªå·¥å…·.\n\nä¹‹åå°±æ˜¯ä¸€ä¸ªbase64åŠ å¯†äº†ä¸€ä¸ªåŠ å¯†å‹ç¼©åŒ…çš„å…ƒæ•°æ®,é€†å‘è§£å¯†ä¸€ä¸‹å°±è¡Œäº†,base64ç¼–ç å’Œå‹ç¼©åŒ…å¯†ç éƒ½åœ¨å‰ªåˆ‡æ¿çš„ä¿¡æ¯é‡Œäº†.\n\næ¥ä¸‹æ¥å°±ä¸€è·¯åˆ°åº•æ‹¿åˆ°flag.\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126161745356.png)\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126161749134.png)![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126161752629.png)\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251126161805329.png)\n\nâ—‹( ï¼¾çš¿ï¼¾)ã£Hiahiahiaâ€¦\n","tags":["CTF"],"categories":["Forensics"]},{"title":"VMware Linux Mouse Wheel Tuning and Smooth Scrolling","url":"/2025/11/09/VmwareLinuxmouseScrolling/","content":"\n# ***VMware Linuxå‘½ä»¤çª—å£é¼ æ ‡æ»‘è½®ä½“éªŒä¼˜åŒ–è§£å†³æ–¹æ¡ˆ***\n\n### ä¸ºä»€ä¹ˆ VMware ä¸‹é¼ æ ‡æ»šè½®æ‰‹æ„Ÿå·®\n\n1. **è™šæ‹Ÿæœºçš„è¾“å…¥å»¶è¿Ÿ**ï¼š\n    VMware æŠŠå®¿ä¸»æœºçš„é¼ æ ‡è¾“å…¥â€œç¿»è¯‘â€æˆè™šæ‹Ÿä¿¡å·å‘é€åˆ°å®¢æœºï¼Œæ»šè½®äº‹ä»¶åˆ†è¾¨ç‡å¾ˆä½ï¼ˆä¸€æ¬¡æ»šåŠ¨å¾€å¾€æ˜¯å¥½å‡ è¡Œï¼‰ã€‚\n\n2. **libinput é»˜è®¤æ­¥é•¿è¿‡å¤§**ï¼š\n    Linux æ¡Œé¢é»˜è®¤æŒ‰â€œè¡Œâ€æ»šåŠ¨ï¼Œè€Œä¸æ˜¯â€œåƒç´ æ»šåŠ¨â€ï¼Œå¯¼è‡´ç‰¹åˆ«è·³ã€‚\n\n3. **æ²¡æœ‰åŠ é€Ÿåº¦è¡¥å¿**ï¼š\n    è™šæ‹Ÿè®¾å¤‡ï¼ˆå¦‚ `VirtualPS/2 VMMouse`ï¼‰é€šå¸¸ä¸æ”¯æŒé«˜ç²¾åº¦æ»šåŠ¨ï¼ˆä¸åƒçœŸå® USB é¼ æ ‡é‚£æ ·æœ‰åˆ†çº§ä¿¡å·ï¼‰ã€‚\n\n   \n\n#### ***å¯ç”¨å¹³æ»‘æ»šåŠ¨*ï¼ˆé’ˆå¯¹ GNOME / libinputï¼‰**\n\nåœ¨å‘½ä»¤è¡Œæ‰§è¡Œï¼š\n\n```\nsudo nano /etc/libinput/local-overrides.quirks\n```\n\næ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\n\n```\n[VMware Virtual Mouse]\nMatchName=VMware VMware Virtual USB Mouse\nAttrScrollMethod=button\nAttrScrollPoints=1\n```\n\nç„¶åé‡å¯æˆ–è¿è¡Œï¼š\n\n```\nsudo udevadm control --reload-rules && sudo udevadm trigger\n```\n\nè‹¥å‡ºç°æŠ¥é”™\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251109222353816.png)\n\nè¿™ä¸ªæç¤ºè¯´æ˜ï¼š\n\n> ä½ çš„ç³»ç»Ÿé‡Œè¿˜æ²¡æœ‰ `/etc/libinput/` è¿™ä¸ªç›®å½•ã€‚\n\nä¸åŒçš„ Linux å‘è¡Œç‰ˆï¼ˆç‰¹åˆ«æ˜¯åœ¨è™šæ‹Ÿæœºä¸­ï¼‰é»˜è®¤å¹¶ä¸ä¼šåˆ›å»ºè¿™ä¸ªæ–‡ä»¶å¤¹ã€‚\n è§£å†³å¾ˆç®€å•ï¼š\n\n------\n\n### æ–¹æ³• ï¼šå…ˆåˆ›å»ºç›®å½•\n\n```\nsudo mkdir -p /etc/libinput\n```\n\nç„¶åå†æ‰§è¡Œï¼š\n\n```\nsudo nano /etc/libinput/local-overrides.quirks\n```\n\nç²˜è´´è¿›å»ï¼š\n\n```\n[VMware Virtual Mouse]          \nMatchName=VMware VMware Virtual USB Mouse   //â€œè®¾å¤‡åŒ¹é…è§„åˆ™â€â€”â€” æŒ‡å®šè¿™ä»½é…ç½®åªå¯¹ â€œåç§°ä¸º VMware è™šæ‹Ÿ USB é¼ æ ‡â€ çš„è®¾å¤‡ç”Ÿæ•ˆ\nAttrScrollMethod=button                     //è®¾ç½®æ»šåŠ¨æ–¹å¼ä¸º â€œæŒ‰é’®æ¨¡æ‹Ÿæ»šåŠ¨â€â€”â€” æŠŠé¼ æ ‡æ»šè½®çš„ â€œè¡Œçº§è§¦å‘â€ï¼ˆé»˜è®¤ä¸€æ¬¡æ»šå¤šè¡Œï¼‰åˆ†æˆ â€œåƒç´ çº§è§¦å‘â€ï¼Œæ˜¯å®ç° â€œå¹³æ»‘æ»šåŠ¨â€ çš„æ ¸å¿ƒï¼›\nAttrScrollPoints=1                          //è®¾ç½®æœ€å°æ»šåŠ¨æ­¥é•¿ä¸º 1 ä¸ªå•ä½ï¼ˆæ¥è¿‘åƒç´ çº§ï¼‰â€”â€” è§£å†³é»˜è®¤ â€œä¸€æ¬¡æ»šå¤šè¡Œâ€ çš„è·³å˜é—®é¢˜ï¼Œè®©æ»šåŠ¨æ›´ç»†è…»ã€‚\n```\n\n\n\nä¿å­˜ï¼ˆ`Ctrl+O` â†’ å›è½¦ â†’ `Ctrl+X` é€€å‡ºï¼‰ï¼Œ\n å†æ‰§è¡Œï¼š\n\n```\nsudo udevadm control --reload-rules && sudo udevadm trigger    //udevadm æ˜¯ Linux ç®¡ç†è®¾å¤‡è§„åˆ™çš„å·¥å…·\n                                                               //é‡æ–°åŠ è½½ç³»ç»Ÿçš„è®¾å¤‡è§„åˆ™ï¼ˆä¿®æ”¹é…ç½®æ–‡ä»¶åï¼Œå¿…é¡»é‡è½½æ‰èƒ½è®© ç³»ç»Ÿè¯†åˆ«æ–°è§„åˆ™ï¼‰\n                                                               //è§¦å‘è®¾å¤‡è§„åˆ™ç”Ÿæ•ˆï¼ˆç›¸å½“äº â€œåˆ·æ–°â€ æ‰€æœ‰è®¾å¤‡ï¼Œè®©æ–°é…ç½®ç«‹å³\nåº”ç”¨åˆ°è™šæ‹Ÿé¼ æ ‡ä¸Šï¼‰ã€‚\n```\n\né‡å¯åç”Ÿæ•ˆã€‚\n\n\n\n### ***ä½¿ç”¨ `imwheel` è®¾ç½®æ»šè½®åŠ é€Ÿ***\n\næ—¢ç„¶ä½ å·²ç»æœ‰å¹³æ»‘æ»šåŠ¨ï¼Œå¯ä»¥è®© `imwheel` å¸®ä½ åŠ é€Ÿå¿«é€Ÿæ»šåŠ¨ï¼š\n\n```\nsudo apt install imwheel -y\n```\n\nç„¶ååˆ›å»ºé…ç½®ï¼š\n\n```\nnano ~/.imwheelrc             //  ~ï¼šä»£è¡¨å½“å‰ç”¨æˆ·çš„ä¸»ç›®å½•ï¼ˆæ¯”å¦‚ä½ çš„ç”¨æˆ·åæ˜¯ userï¼Œè·¯å¾„å°±æ˜¯ /home/user/ï¼‰\n                              //  .imwheelrcï¼šimwheel çš„é…ç½®æ–‡ä»¶ï¼ˆæ–‡ä»¶åå‰åŠ  . è¡¨ç¤º â€œéšè—æ–‡ä»¶â€ï¼Œä¸“é—¨å­˜æ”¾ä¸ªäººçš„å·¥å…·é…ç½®ï¼‰\n```\n\nå†…å®¹å¦‚ä¸‹ ğŸ‘‡ï¼š\n\n```\n\".*\"\nNone,      Up,   Button4, 5\nNone,      Down, Button5, 5\nControl_L, Up,   Button4, 10\nControl_L, Down, Button5, 10\nShift_L,   Up,   Button4, 2\nShift_L,   Down, Button5, 2\n```\n\n|             é…ç½®è¡Œ             |         è¾…åŠ©é”®          |   æ»šè½®æ–¹å‘   | é¼ æ ‡æŒ‰é”® | æ»šåŠ¨å€ç‡ |                    å®é™…æ•ˆæœï¼ˆé€šä¿—ç†è§£ï¼‰                     |\n| :----------------------------: | :---------------------: | :----------: | :------: | :------: | :---------------------------------------------------------: |\n|     `None, Up, Button4, 5`     |     Noneï¼ˆæ— æŒ‰é”®ï¼‰      |  Upï¼ˆä¸Šæ»šï¼‰  | Button4  |    5     | æ—¥å¸¸é»˜è®¤æ»šåŠ¨ï¼šæ»šä¸€ä¸‹ç›¸å½“äºåŸæ¥çš„ 5 å€é€Ÿåº¦ï¼ˆå¹³è¡¡å¹³æ»‘ä¸æ•ˆç‡ï¼‰ |\n|    `None, Down, Button5, 5`    |     Noneï¼ˆæ— æŒ‰é”®ï¼‰      | Downï¼ˆä¸‹æ»šï¼‰ | Button5  |    5     |                    åŒä¸Šï¼Œä¸‹æ»šçš„é»˜è®¤åŠ é€Ÿ                     |\n|  `Control_L, Up, Button4, 10`  | Control_Lï¼ˆå·¦ Ctrl é”®ï¼‰ |  Upï¼ˆä¸Šæ»šï¼‰  | Button4  |    10    |       æŒ‰ä½ Ctrl + ä¸Šæ»šï¼šå¿«é€Ÿæ»šåŠ¨ï¼ˆé€‚åˆé•¿æ–‡æ¡£ / ç½‘é¡µï¼‰       |\n| `Control_L, Down, Button5, 10` | Control_Lï¼ˆå·¦ Ctrl é”®ï¼‰ | Downï¼ˆä¸‹æ»šï¼‰ | Button5  |    10    |                 æŒ‰ä½ Ctrl + ä¸‹æ»šï¼šå¿«é€Ÿä¸‹æ»š                  |\n|   `Shift_L, Up, Button4, 2`    | Shift_Lï¼ˆå·¦ Shift é”®ï¼‰  |  Upï¼ˆä¸Šæ»šï¼‰  | Button4  |    2     |     æŒ‰ä½ Shift + ä¸Šæ»šï¼šç²¾ç»†æ»šåŠ¨ï¼ˆé€‚åˆä»£ç  / è¡¨æ ¼å¯¹é½ï¼‰      |\n|  `Shift_L, Down, Button5, 2`   | Shift_Lï¼ˆå·¦ Shift é”®ï¼‰  | Downï¼ˆä¸‹æ»šï¼‰ | Button5  |    2     |                 æŒ‰ä½ Shift + ä¸‹æ»šï¼šç²¾ç»†ä¸‹æ»š                 |\n\nä¿å­˜é€€å‡ºåï¼Œè¿è¡Œï¼š\n\n```\nimwheel -kill\n```\n\nä½ å¯ä»¥åå¤è°ƒæœ€åé‚£ä¸ªæ•°å­—ï¼ˆ5ï¼‰ï¼š\n\n- è¶Šå¤§ â†’ æ»šåŠ¨é€Ÿåº¦æ›´å¿«ï¼ˆé€‚åˆé«˜åˆ†è¾¨ç‡å±å¹•ï¼‰ï¼›\n- è¶Šå° â†’ æ›´è‡ªç„¶ã€‚","tags":["Preferences"],"categories":["Preferences"]},{"title":"Block-chain Signln","url":"/2025/10/28/Blockchain  SignIn/","content":"\n# ***Block-chain  Signln***\n\n<from geekchallenge>\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251029163022356.png)\n\né¢˜ç›®ç»™äº†æˆ‘ä»¬åŒºå—hashï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥è¯¢~***[TESTNET Sepolia (ETH) Blockchain Explorer](https://sepolia.etherscan.io/)***\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251029163110698.png)\n\næ ¹æ®hashæŸ¥è¯¢äº¤æ˜“ä¿¡æ¯\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251029163114779.png)\n\nè¿™é‡Œclick to SHOW MORE\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251029163120495.png)\n\nå‘ç°ä¸€ä¸ªINPUT DATAæ˜¯hexè½¬ä¸€ä¸‹ï¼Œå¾—åˆ°flagã€‚\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251029163124653.png)\n\nâ˜†*: .ï½¡. o(â‰§â–½â‰¦)o .ï½¡.:*â˜†ã€Š~â˜†~ã€‹*: .ï½¡. o(â‰§â–½â‰¦)o .ï½¡.:*â˜† ","tags":["CTF"],"categories":["Blockchain"]},{"title":"traffic 1","url":"/2025/10/28/GFSJ_traffic1/","content":"# ***traffic 1***\n\n*<from Gfsj_misc_Traffic Analysis>*\n\næœ‰tcpæ— httpï¼Œæ€€ç–‘tls\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030103420190.png)\n\nè¿‡æ»¤tls\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030103424488.png)\n\nå¤§é‡tlsv1.2åè®®ã€‚\n\nå‘ç°Encryptå­—æ®µï¼Œæ€€ç–‘è§£å¯†ã€‚\n\næœç´¢keyæ²¡æœ‰å‘ç°ï¼Œå†çœ‹äº†çœ‹å‘ç°æœ‰ftpåè®®ï¼Œçœ‹çœ‹ä»€ä¹ˆæ¨¡å¼ã€‚\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030103428217.png)\n\nä¸ç®¡äº†ç›´æ¥æœftp-dataåè®®ï¼ˆä¸»åŠ¨æ¨¡å¼ä¸‹æ— ftp-dataæ•°æ®åŒ…ï¼Œè¢«åŠ¨æ¨¡å¼æœ‰ï¼‰\n\nä¼ è¾“äº†å¤§é‡key.logæ–‡ä»¶\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030103428217.png)\n\nè¿½è¸ªæµã€‚\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030103432448.png)\n\næ¯ä¸€è¡Œéƒ½ä»¥ `CLIENT_RANDOM` å¼€å¤´ï¼Œåé¢è·Ÿç€ä¸¤ä¸ªé•¿ä¸²çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚è¿™æ˜¯å…¸å‹çš„ **TLSï¼ˆä¼ è¾“å±‚å®‰å…¨åè®®ï¼‰å¯†é’¥æ—¥å¿—æ ¼å¼**ï¼Œç”¨äºè§£å¯†  åŠ å¯†æµé‡ã€‚\n\næˆ‘ä»¬å¯¼å‡ºä¿å­˜ä¸ºkey.log\n\nä¹‹åå¯¹åŠ å¯†æµé‡åŒ…è§£å¯†ã€‚è¿›å…¥***ç¼–è¾‘ â†’ é¦–é€‰é¡¹ â†’ åè®® â†’ TLS***\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030103436331.png)\n\nç‚¹å‡»åº”ç”¨å®Œæˆè§£å¯†ã€‚å¦‚æœè§£å¯†ä¸æˆåŠŸå¯ä»¥è¯•è¯•æŠŠdebug fileæ·»åŠ ä¸Šã€‚\n\nè§£å¯†æˆåŠŸã€‚\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030103439925.png)\n\nå¯¼å‡ºhttpã€‚\n\næ–‡ä»¶æœ‰ç‚¹å¤šï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©å¯ç–‘çš„å¯¼å‡ºã€‚\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030103443960.png)\n\nè¿™é‡Œæœ‰ä¸ªzipå¯¼å‡ºä¸€ä¸‹ã€‚å‘ç°æ˜¯ä¸€ä¸ªéŸ³é¢‘ã€‚\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030103448382.png)\n\nå°¾éƒ¨æœ‰å™ªéŸ³ã€‚Audacityæ‰“å¼€ã€‚\n\né¢‘è°±å›¾çœ‹ä¸€ä¸‹å°¾éƒ¨ã€‚\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030103452336.png)\n\nå‘ç°æ˜¯keyä¸æ˜¯flagï¼Œè¯´æ˜æˆ‘ä»¬é—æ¼äº†ä»€ä¹ˆä¸œè¥¿ã€‚å›å¤´çœ‹çœ‹ã€‚\n\nä¸ç®¡äº†ï¼Œè¿™é‡Œç›´æ¥binwalk+foremostä¸€ä¸‹ã€‚\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030103457987.png)\n\nåˆ†ç†å‡º2ä¸ªå‹ç¼©åŒ…ã€‚\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030103503383.png)\n\nè¾“å…¥åˆšæ‰çš„key\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030103507403.png)\n\nå¾—åˆ°flagï¼š***flag{4sun0_y0zora_sh0ka1h@n_#>><<#}***\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030103512520.png)\n\nâ—‹( ï¼¾çš¿ï¼¾)ã£Hiahiahiaâ€¦","tags":["CTF"],"categories":["Forensics"]},{"title":"evil_mcp","url":"/2025/10/28/evil_mcp/","content":"# ***evil_mcp***\n\n*<from geekchallenge>*\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030105202206.png)\n\n**ez_AI**ï¼šæ‰“å¼€ç¯å¢ƒ\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030105205382.png)\n\n*è¿™é‡Œæ€è·¯æ˜¯ç¼–å†™ä¸€ä¸ªè„šæœ¬æ³¨å…¥è·å–flag*\n\n```\nfrom typing import Any\n\n@tool(\n    name=\"get_flag\",\n    description=\"Get the flag from the server\",\n    input_schema={\n        \"type\": \"object\",\n        \"properties\": {},\n        \"required\": []\n    }\n)\nasync def get_flag(arguments: dict[str, Any], context: Any) -> Any:\n    \"\"\"Get the flag.\"\"\"\n    with open('/flag', 'r') as f:\n        content = f.read()\n    return content\n```\n\nç²˜è´´è¿›MCPå·¥å…·ä»£ç æ¡†ï¼Œä¿å­˜å¹¶åŠ è½½å·¥å…·ã€‚\n\næœ€åget_flagå°±è¡Œã€‚\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030105210043.png)\n\nâ˜†*: .ï½¡. o(â‰§â–½â‰¦)o .ï½¡.:*â˜†å–”è€¶!\n","tags":["CTF"],"categories":["AI"]},{"title":"ESPå®šå¾‹","url":"/2025/10/28/è„±å£³ESPï¼ˆæ‰©å±•æ ˆæŒ‡é’ˆï¼‰å®šå¾‹/","content":"# ***ESPï¼ˆæ‰©å±•æ ˆæŒ‡é’ˆï¼‰***\n\n***principleï¼š***\n\n*åœ¨ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œæ ˆçš„æ“ä½œä¸å‡½æ•°è°ƒç”¨ã€å±€éƒ¨å˜é‡å­˜å‚¨ç­‰å¯†åˆ‡ç›¸å…³ã€‚å½“ç¨‹åºæ‰§è¡Œåˆ°æŸä¸ªå‡½æ•°è°ƒç”¨æ—¶ï¼Œä¼šå°†å‡½æ•°çš„å‚æ•°ã€è¿”å›åœ°å€ç­‰ä¿¡æ¯å‹å…¥æ ˆä¸­ï¼Œè€Œ ESP åˆ™å§‹ç»ˆæŒ‡å‘æ ˆé¡¶ã€‚****X86 expå¯„å­˜å™¨å­˜å‚¨çš„æ˜¯å½“å‰æ ˆé¡¶çš„å†…å­˜åœ°å€ã€‚***\n\n***Functionï¼š***\n\nESP å®šå¾‹çš„æ ¸å¿ƒåŸç†åŸºäºæ ˆçš„å¹³è¡¡æœºåˆ¶ã€‚åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œç‰¹åˆ«æ˜¯åœ¨åŠ å¯†ç¨‹åºæˆ–å­˜åœ¨ä»£ç ä¿æŠ¤æœºåˆ¶çš„è½¯ä»¶ä¸­ï¼Œç¨‹åºå¯èƒ½ä¼šå¯¹è‡ªèº«ä»£ç è¿›è¡ŒåŠ å¯†æˆ–æ··æ·†å¤„ç†ï¼Œä½¿å¾—ç›´æ¥åˆ†æåŸå§‹ä»£ç å˜å¾—å›°éš¾ã€‚ç„¶è€Œï¼Œ**å½“ç¨‹åºæ‰§è¡Œåˆ°ç‰¹å®šå…³é”®ä»£ç æ®µï¼ˆå¦‚è§£å¯†åçš„ä»£ç éƒ¨åˆ†ï¼‰æ—¶ï¼Œé€šå¸¸ä¼šæ¶‰åŠåˆ°æ ˆçš„æ“ä½œï¼Œå¯¼è‡´ ESP çš„å€¼å‘ç”Ÿæœ‰è§„å¾‹çš„å˜åŒ–**ã€‚é€šè¿‡**ç›‘æµ‹ ESP çš„å€¼å˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¿™äº›å…³é”®ä»£ç çš„æ‰§è¡Œç‚¹**ã€‚\n\n***CPPï¼š***\n\n```\n`#include <iostream>`\n\n`void encryptedFunction() {`\n`// è¿™é‡Œå‡è®¾æ˜¯ä¸€äº›åŠ å¯†åçš„ä»£ç é€»è¾‘`\n`std::cout << \"This is the encrypted part of the code.\" << std::endl;`\n`}`\n\n`int main() {`\n`// è°ƒç”¨åŠ å¯†å‡½æ•°å‰çš„æ ˆçŠ¶æ€`\n`int localVar1 = 10;`\n`int localVar2 = 20;`\n\n\nencryptedFunction();\n\n// è°ƒç”¨åŠ å¯†å‡½æ•°åçš„æ ˆçŠ¶æ€\nstd::cout << \"After the function call, localVar1: \" << localVar1 << \", localVar2: \" << localVar2 << std::endl;\n\nreturn 0;\n\n}\n```\n\n\n\n***ä¸ªäººç†è§£ï¼ˆä»…ä¾›å‚è€ƒï¼‰ï¼š***\n\n*ESPï¼ˆæ‰©å±•æ ˆæŒ‡é’ˆï¼‰*ï¼šå¯¹äºè°ƒç”¨å‡½æ•°ç­‰æ“ä½œï¼Œåœ¨å¯¹å…³é”®ä»£ç è¿›è¡Œå®šä½æŸ¥æ‰¾çš„å›°éš¾è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥é€šè¿‡è§‚å¯ŸESPçš„å€¼è¿›è¡Œå¯¹å‡½æ•°åœ°å€çš„å®šä½ï¼Œæ¯”å¦‚ç¨‹åºåœ¨è°ƒç”¨**encryptedFunction**å‡½æ•°æ—¶ï¼Œä¼šæ¶‰åŠåˆ°æ ˆçš„æ“ä½œï¼Œå¯¼è‡´ ESP çš„å€¼å‘ç”Ÿæœ‰è§„å¾‹çš„å˜åŒ–ã€‚é€šè¿‡ç›‘æµ‹ ESP çš„å€¼å˜åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°è¿™äº›å…³é”®ä»£ç çš„æ‰§è¡Œç‚¹ã€‚\n\n\n\n\n\n***Exampleï¼š***\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030104434071.png)\n\n\n\n**æˆ‘åˆ›å»ºäº†ä¸€ä¸ªç®€å•çš„PEæ–‡ä»¶ï¼Œå¹¶å¯¹å…¶è¿›è¡ŒåŸºç¡€åŠ å£³upx -d  project1.exe**\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030104438830.png)\n\n\n\n**æ¥ç€å¯¹upxç‰¹å¾æ®µè¿›è¡Œç¯¡æ”¹ä½¿å…¶æ— æ³•è¢«åŸºç¡€è„±å£³æ‰ã€‚å¦‚ä¸‹å›¾**ï¼š\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030104443152.png)\n\n\n\n\n\n**ç„¶åé’ˆå¯¹æ­¤ç±»åŠ å£³æˆ‘ä»¬å¯ä»¥ç”¨espå®šå¾‹è¿›è¡ŒåŠ¨æ€è°ƒè¯•æ¥å®Œæˆè„±å£³ã€‚**\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030104446580.png)\n\n\n\n\n\né¦–å…ˆå•æ­¥è°ƒè¯•ï¼Œå‘ç°ESPå¯„å­˜å™¨å‡ºå¤§çº¢ï¼ˆ**ESP å¯„å­˜å™¨å˜çº¢è¡¨ç¤ºæ ˆæŒ‡é’ˆï¼ˆStack Pointerï¼‰çš„å€¼å‘ç”Ÿäº†å¼‚å¸¸æˆ–ä¸ä¸€è‡´ï¼Œå¯èƒ½è§¦å‘äº†æ ˆå¹³è¡¡é”™è¯¯ã€‚**ï¼‰\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030104449794.png)\n\n\n\n\n\n**å°†å†…å­˜çª—å£çš„æ˜¾ç¤ºå®šä½åˆ°ä¸è¯¥å¯„å­˜å™¨å€¼ç›¸å…³çš„å†…å­˜åœ°å€å¤„ï¼Œæ–¹ä¾¿æŸ¥çœ‹å¯¹åº”å†…å­˜åœ°å€ä¸­çš„æ•°æ®ã€‚**\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030104453237.png)\n\n\n\n\n\n**ä»»æ„å­—ç¬¦ä¸‹ç¡¬ä»¶æ–­ç‚¹**\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030104456305.png)\n\n\n\n\n\n**run to line(jmp project.6c1023)ï¼Œæ‰¾åˆ°[OEP]ï¼ˆ ç¨‹åºçš„å…¥å£ç‚¹ ï¼‰**\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030104459583.png)\n\n\n\n\n\n**è®¾ç½®EIPï¼Œæ”¶å·¥ã€‚**\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030104503551.png)\n\n\n\n\n\n**æœ€ådumpä¸‹æ¥ï¼Œæ£€éªŒä¸€ä¸‹ã€‚**\n\n![img](https://raw.githubusercontent.com/HuA-m1/Pic%20/main/pic/20251030104507280.png)\n\n**è„±å£³æˆåŠŸï¼**ğŸ™ŒğŸ™ŒğŸ™Œ","tags":["CTF"],"categories":["Reverse"]}]